<!DOCTYPE html>
<html>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>

<head>

<style>

a {
    text-decoration: none;
    display: inline-block;
    padding: 4px 8px;
}

a:hover {
    background-color: #ddd;
    color: black;
}

.previous {
    background-color: #f1f1f1;
    color: black;
}

.next {
    background-color: #4CAF50;
    color: white;
}

.round {
    border-radius: 50%;
}
button.accordion {
    background-color: #eee;
    color: #444;
    cursor: pointer;
    padding: 18px;
    width: 100%;
    border: none;
    text-align: left;
    outline: none;
    font-size: 15px;
    transition: 0.4s;
}

button.accordion.active, button.accordion:hover {
    background-color: #ddd; 
}

div.panel {
    padding: 0 18px;
    display: none;
    background-color: white;
}
.axis {
	  font: 12px sans-serif;
	}

	.axis path,
	.axis line {
	  fill: none;
	  stroke: #000;
	  shape-rendering: crispEdges;
	}
.line {
  fill: none;
  stroke: steelblue;
  stroke-width: 2px;
}

body {
  margin: 15px;
  background-color: #F1F3F3    
}
.bar {
	fill: #6F257F;
}
.axis path,
.axis line {
  fill: none;
  stroke: #D4D8DA;
  stroke-width: 1px;
  shape-rendering: crispEdges;
}
.x path {
	display: none;
}
.toolTip {
  position: absolute;
  display: none;
  min-width: 80px;
  height: auto;
  background: none repeat scroll 0 0 #ffffff;
  border: 1px solid #6F257F;
  padding: 14px;
  text-align: center;
}

</style>

</head>

<body>


<button class="accordion">About this Visualization</button>
<div class="panel">
  <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
</div>


<p>Click the button to trigger a function that will output "Hello World" in a p element with id="demo".</p>


<button onclick="myFunction1()">1</button>
<button onclick="myFunction2()">2</button>
<button onclick="myFunction3()">3</button>






<div id="svg-container">
    <svg id="viz" width="1020" height="605" > </svg>
</div>



<p id="demo"></p>

<script>

var acc = document.getElementsByClassName("accordion");
var i;

for (i = 0; i < acc.length; i++) {
    acc[i].onclick = function(){
        this.classList.toggle("active");
        var panel = this.nextElementSibling;
        if (panel.style.display === "block") {
            panel.style.display = "none";
        } else {
            panel.style.display = "block";
        }
    }
}



function myFunction1() {

d3.selectAll("svg > *").remove();
document.getElementById("demo").innerHTML = "Stacked bar chart";


  // text label for the x axis
	//  d3.select(document.getElementById("viz")).append("text")             
	//	  .attr("transform",
	//			"translate(" + (w/2) + " ," + 
	//						   (h + margin.top + 20) + ")")
	//	  .style("text-anchor", "middle")
	//	  .text("Date");

  
d3.select(document.getElementById("viz"))
.attr("width", 720)
.attr("height", 505);				


	//Original data
	var dataset = [
		{ profit: 177337, sales: 3178638-177337 }, // note sales actually is 3178638
		{ profit: 451990, sales: 2258384-451990 },
		{ profit: 683088, sales: 3515005-683088 }
		
	];

	//Set up stack method
	var stack = d3.stack()
				  .keys([ "profit", "sales" ])
				  .order(d3.stackOrderAscending);  

	//Data, stacked
	var series = stack(dataset);

	
				

	var svg = d3.select("svg"),
    margin = {top: 100, right: 300, bottom: 50, left: 100},
    width = +svg.attr("width") - margin.left - margin.right
    height = +svg.attr("height") - margin.top - margin.bottom;
    g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");

	
	//Set up scales
	var x = d3.scaleBand()
		.domain(d3.range(dataset.length))
		.range([0, width])
		.paddingInner(0.05)
		.align(0.1);

		
	var y = d3.scaleLinear()
		.domain([0, d3.max(dataset, function(d) {
				return d.profit + d.sales;
			})
		])
		.range([height, 0]);  // <-- Flipped vertical scale
		
	//Easy colors accessible via a 10-step ordinal scale
	var colors = d3.scaleOrdinal(d3.schemeCategory10);
	
	
	// Add a group for each row of data
	
	
	
	g.append("g")
    .selectAll("g")
    .data(series)
    .enter().append("g")
      .attr("fill", function(d, i) {
			return colors(i);
		})
    .selectAll("rect")
    .data(function(d) { return d; })
    .enter().append("rect")
      .attr("x", function(d, i) { return x(i); })
      .attr("y", function(d) { return y(d[1]); })
      .attr("height", function(d) { return y(d[0]) - y(d[1]); })
      .attr("width", x.bandwidth())
	  .on("mouseover", function() { tooltip.style("display", null); })
      .on("mouseout", function() { tooltip.style("display", "none"); })
      .on("mousemove", function(d) {
      // console.log(d);
      var xPosition = d3.mouse(this)[0] - 5;
      var yPosition = d3.mouse(this)[1] - 5;
      tooltip.attr("transform", "translate(" + xPosition + "," + yPosition + ")");
  //    tooltip.select("text").text(d[1]-d[0]);
	  tooltip.select("text").text(d[1]);
    });
	

	
	
 var tickLabels = ['Furniture','Office Supply','Technology']

 


// x-axis

  g.append("g")
      .attr("class", "axis")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x).tickFormat(function(d,i){ return tickLabels[i] }))
	  .append("text")
            .attr("x", (width - margin.left)/ 2)
            .attr("y", margin.bottom * 0.9)
            .attr("dx", "0.32em")
            .attr("fill", "#000")
            .attr("font-weight", "bold")
            .attr("text-anchor", "start")
			.attr("font-family", "sans-serif")
			.attr("font-size", 14)
            .text("Department");

// Left y-axis
			
	g.append("g")
      .attr("class", "axis")
      .call(d3.axisLeft(y).ticks(null, "s"))
    .append("text")
      .attr("x", - 0.8*margin.left)
     // .attr("y", y(y.ticks().pop()) + 0.5)
	  .attr("y", height/2)
      .attr("dy", "0.32em")
      .attr("fill", "#000")
      .attr("font-weight", "bold")
      .attr("text-anchor", "start")
	  .attr("font-size", "14px")
      .text("Sales");

// Right y-axis
	  
	  g.append("g")
      .attr("class", "axis")
      .call(d3.axisRight(y).ticks(null, "s"))
	  .attr("transform", "translate (" + width + ", 0)")
    .append("text")
      .attr("x", 0.15*margin.right)
	  .attr("y", height/2)
      .attr("dy", "0.32em")
      .attr("fill", "#000")
      .attr("font-weight", "bold")
      .attr("text-anchor", "start")
	  .attr("font-size", "14px")
      .text("Profit");
	
// Legend
	
	var legend = g.append("g")
      .attr("font-family", "sans-serif")
      .attr("font-size", 14)
	  .attr("font-weight", "normal")
      .attr("text-anchor", "end")
    .selectAll("g")
    .data(["Profit", "Sales"])
    .enter().append("g")
      .attr("transform", function(d, i) { return "translate(0," + i * 20 + ")"; });

	 

	  legend.append("text")
		  .attr("x", width + 0.35* margin.right)
		  .attr("y", 9.5)
		  .attr("dy", "0.32em")
		  .attr("font-family", "sans-serif")
		  .attr("font-size", 14)
		  .text(function(d) { return d; });
	
	legend.append("rect")
		  .attr("x", width + 0.4*margin.right)
		  .attr("width", 19)
		  .attr("height", 19)
		  .attr("fill", function(d,i){return colors(i)});
	  
  

	  
// Prep the tooltip bits, initial display is hidden
  var tooltip = svg.append("g")
    .attr("class", "tooltip")
    .style("display", "none");
      
  tooltip.append("rect")
    .attr("width", 60)
    .attr("height", 20)
    .attr("fill", "white")
    .style("opacity", 0.5);

  tooltip.append("text")
    .attr("x", 20)
    .attr("dy", "1.2em")
    .style("text-anchor", "middle")
    .attr("font-size", "12px")
    .attr("font-weight", "bold");  
	 
  

}
function myFunction2() {

d3.selectAll("svg > *").remove();
document.getElementById("demo").innerHTML = "Stacked bar chart";

d3.select(document.getElementById("viz"))
.attr("width", 1120)
.attr("height", 605);

var dataset = [
		{ region: "central", dept: "furniture", profit: 53987, sales: 785116-53987, ind: 0},
		{ region: "central", dept: "office supplies", profit: 124093, sales: 530530-124093, ind: 1},
		{ region: "central", dept: "technology", profit: 280588, sales: 978957-280588, ind: 2 },
		
		{ region: "east", dept: "furniture", profit: 39185, sales: 1150249-39185, ind: 3 },
		{ region: "east", dept: "office supplies", profit: 201480, sales: 938107-201480, ind: 4},
		{ region: "east", dept: "technology", profit: 234359, sales: 1054766-234359, ind: 5 },
		
		{ region: "south", dept: "furniture", profit: 18835, sales: 516757-18835, ind: 6 },
		{ region: "south", dept: "office supplies", profit: 60786, sales: 353242-60786, ind: 7},
		{ region: "south", dept: "technology", profit: 27524, sales: 641950-27524, ind: 8},
		
		{ region: "west", dept: "furniture", profit: 65330, sales: 726516-65330, ind: 9},
		{ region: "west", dept: "office supplies", profit: 65631, sales: 436505-65631, ind: 10},
		{ region: "west", dept: "technology", profit: 140617, sales: 839332-140617, ind: 11 }
	];
	
	
	
  
  
//Set up stack method
	var stack = d3.stack()
				  .keys([ "profit", "sales" ])
				  .order(d3.stackOrderAscending);  

//Data, stacked
	var series = stack(dataset);


	
	
	var svg = d3.select("svg"),
    margin = {top: 20, right: 160, bottom: 100, left: 120},
    width = +svg.attr("width") - margin.left - margin.right
    height = +svg.attr("height") - margin.top - margin.bottom;
    g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  
var tooltip = d3.select("body").append("div").attr("class", "toolTip");
  



  
//Set up scales

//Set up scales
	var x = d3.scaleBand()
		.domain(d3.range(dataset.length))
		.range([0, width])
		.paddingInner(0.05)
		.align(0.1);

		
	var y = d3.scaleLinear()
		.domain([0, d3.max(dataset, function(d) {
				return d.profit + d.sales;
			})
		])
		.range([height, 0]);  // <-- Flipped vertical scale
	
	
 
 //Color array based on schemeCategory20
	

	
	
	var colors1 = d3.scaleOrdinal(d3.schemeCategory20);
	
	var colors  = ["#1f77b4", "#1f77b4", "#1f77b4", "#ff7f0e", "#ff7f0e","#ff7f0e", "#2ca02c", "#2ca02c", "#2ca02c",  "#d62728", "#d62728", "#d62728", 
				"#aec7e8", "#aec7e8", "#aec7e8", "#ffbb78", "#ffbb78","#ffbb78", "#98df8a", "#98df8a", "#98df8a",  "#ff9896", "#ff9896", "#ff9896"];
	
	var color_ind = 0; // global counter
	

	
	g.append("g")
    .selectAll("g")
    .data(series)
    .enter().append("g")
     // .attr("fill", function(d,i) {
	//		return colors[i];
	//	})
    .selectAll("rect")
    .data(function(d) { return d; })
    .enter().append("rect")
      .attr("x", function(d, i) {  return x(i); })
      .attr("y", function(d) {  return y(d[1]); })
      .attr("height", function(d) { return y(d[0]) - y(d[1]); })
      .attr("width", x.bandwidth())
	  .attr("fill", function(d,i){ return colors[color_ind++];})
	  .on("mouseover", function() { tooltip.style("display", null); })
      .on("mouseout", function() { tooltip.style("display", "none"); })
      .on("mousemove", function(d) {
      var xPosition = d3.mouse(this)[0] - 5;
      var yPosition = d3.mouse(this)[1] - 5;
      tooltip.attr("transform", "translate(" + xPosition + "," + yPosition + ")");
 //     tooltip.select("text").text(d[1]-d[0]);
	  tooltip.select("text").text(d[1]);
    });
	
	 var tickLabelsInt = ['Furniture','Office Supply','Technology']

    var tickLabels = {};
	for(var i = 0, len = dataset.length; i < len; ++i)
		tickLabels[i] = tickLabelsInt[i%3];
	
// x-axis

  g.append("g")
      .attr("class", "axis")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x).tickFormat(function(d,i){ return tickLabels[i] }))
	  .append("text")
		.attr("x", 0.1* (width - margin.left))
		.attr("y", margin.bottom * 0.6)
		.attr("dx", "0.32em")
		.attr("fill", "#000")
		.attr("font-weight", "bold")
		.attr("text-anchor", "start")
		.attr("font-family", "sans-serif")
		.attr("font-size", 14)
		.attr("word-spacing", 160)
		.text("Central East South West")
			
			
  g.append("g")
	  .append("text")
	 .attr("x", (width - margin.left)/ 2)
	.attr("y", height + 0.9*margin.bottom)
	.attr("dx", "0.32em")
//	.attr("dy", "7.0em")
	.attr("fill", "#000")
	.attr("font-weight", "bold")
	.attr("text-anchor", "start")
	.attr("font-family", "sans-serif")
	.attr("font-size", 14)
	.text("Region/Department");

			
			
// Left y-axis
			
	g.append("g")
      .attr("class", "axis")
      .call(d3.axisLeft(y).ticks(null, "s"))
    .append("text")
      .attr("x", - 0.95 *margin.left)
     // .attr("y", y(y.ticks().pop()) + 0.5)
	  .attr("y", height/2)
      .attr("dy", "0.32em")
      .attr("fill", "#000")
      .attr("font-weight", "bold")
      .attr("text-anchor", "start")
	  .attr("font-size", "14px")
      .text("Sales/Profit");

// Right y-axis

  
	  g.append("g")
     .attr("class", "axis")
    .call(d3.axisRight(y).ticks(null, "s"))
	  .attr("transform", "translate (" + width + ", 0)")
    .append("text")
      .attr("x", 0.35*margin.right)
	  .attr("y", height/2)
      .attr("dy", "0.32em")
      .attr("fill", "#000")
     .attr("font-weight", "bold")
      .attr("text-anchor", "start")
	  .attr("font-size", "14px")
      .text("Sales/Profit");
	
// Legend
	
	var legend = g.append("g")
      .attr("font-family", "sans-serif")
      .attr("font-size", 14)
	  .attr("font-weight", "normal")
      .attr("text-anchor", "end")
    .selectAll("g")
    .data(["Central Profit", "Central Sales", "East Profit", "East Sales", "South Profit", "South Sales", "West Profit", "West Sales"])
    .enter().append("g")
      .attr("transform", function(d, i) { return "translate(0," + i * 20 + ")"; });

	 

	  legend.append("text")
		  .attr("x", width + 0.80 * margin.right)
		  .attr("y", 9.5)
		  .attr("dy", "0.32em")
		  .attr("font-family", "sans-serif")
		  .attr("font-size", 14)
		  .text(function(d) { return d; });
	
	legend.append("rect")
		  .attr("x", width + 0.85 * margin.right)
		  .attr("width", 39)
		  .attr("height", 19)
		  .attr("fill", function(d,i){return colors1(i)});
	  
  

	  
// Prep the tooltip bits, initial display is hidden
  var tooltip = svg.append("g")
    .attr("class", "tooltip")
    .style("display", "none");
      
  tooltip.append("rect")
    .attr("width", 60)
    .attr("height", 20)
    .attr("fill", "white")
    .style("opacity", 0.5);

  tooltip.append("text")
    .attr("x", 30)
    .attr("dy", "1.2em")
    .style("text-anchor", "middle")
    .attr("font-size", "12px")
    .attr("font-weight", "bold");  	

    
}

function myFunction3() {

d3.selectAll("svg > *").remove();
document.getElementById("demo").innerHTML = "Stacked bar chart";

d3.select(document.getElementById("viz"))
.attr("width", 1020)
.attr("height", 605);

var dataset = [
		{ region: "central", dept: "furniture", profit: 53987, sales: 785116, ind: 0},
		{ region: "central", dept: "office supplies", profit: 124093, sales: 530530, ind: 1},
		{ region: "central", dept: "technology", profit: 280588, sales: 978957, ind: 2 },
		
		{ region: "east", dept: "furniture", profit: 39185, sales: 1150249, ind: 3 },
		{ region: "east", dept: "office supplies", profit: 201480, sales: 938107, ind: 4},
		{ region: "east", dept: "technology", profit: 234359, sales: 1054766, ind: 5 },
		
		{ region: "south", dept: "furniture", profit: 18835, sales: 516757, ind: 6 },
		{ region: "south", dept: "office supplies", profit: 60786, sales: 353242, ind: 7},
		{ region: "south", dept: "technology", profit: 27524, sales: 641950, ind: 8},
		
		{ region: "west", dept: "furniture", profit: 65330, sales: 726516, ind: 9},
		{ region: "west", dept: "office supplies", profit: 65631, sales: 436505, ind: 10},
		{ region: "west", dept: "technology", profit: 140617, sales: 839332, ind: 11 }
	];
	
	
	
  
  
//Set up stack method
	var stack = d3.stack()
				  .keys([ "profit", "sales" ])
				  .order(d3.stackOrderAscending);  

//Data, stacked
	var series = stack(dataset);


	
	
	var svg = d3.select("svg"),
    margin = {top: 20, right: 120, bottom: 100, left: 100},
    width = +svg.attr("width") - margin.left - margin.right
    height = +svg.attr("height") - margin.top - margin.bottom;
    g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  
var tooltip = d3.select("body").append("div").attr("class", "toolTip");
  



  
//Set up scales

//Set up scales
	var x = d3.scaleBand()
		.domain(d3.range(dataset.length))
		.range([0, width])
		.paddingInner(0.05)
		.align(0.1);

		
	var y = d3.scaleLinear()
		.domain([0, d3.max(dataset, function(d) {
				return d.profit + d.sales;
			})
		])
		.range([height, 0]);  // <-- Flipped vertical scale
	
	
 
 //Color array based on schemeCategory20
	

	
	
	var colors1 = d3.scaleOrdinal(d3.schemeCategory20);
	
	var colors  = ["#1f77b4", "#1f77b4", "#1f77b4", "#ff7f0e", "#ff7f0e","#ff7f0e", "#2ca02c", "#2ca02c", "#2ca02c",  "#d62728", "#d62728", "#d62728", 
				"#aec7e8", "#aec7e8", "#aec7e8", "#ffbb78", "#ffbb78","#ffbb78", "#98df8a", "#98df8a", "#98df8a",  "#ff9896", "#ff9896", "#ff9896"];
	
	var color_ind = 0; // global counter
	

	
	g.append("g")
    .selectAll("g")
    .data(series)
    .enter().append("g")
     // .attr("fill", function(d,i) {
	//		return colors[i];
	//	})
    .selectAll("rect")
    .data(function(d) { return d; })
    .enter().append("rect")
      .attr("x", function(d, i) {  return x(i); })
      .attr("y", function(d) {  return y(d[1]); })
      .attr("height", function(d) { return y(d[0]) - y(d[1]); })
      .attr("width", x.bandwidth())
	  .attr("fill", function(d,i){ return colors[color_ind++];})
	  .on("mouseover", function() { tooltip.style("display", null); })
      .on("mouseout", function() { tooltip.style("display", "none"); })
      .on("mousemove", function(d) {
      var xPosition = d3.mouse(this)[0] - 5;
      var yPosition = d3.mouse(this)[1] - 5;
      tooltip.attr("transform", "translate(" + xPosition + "," + yPosition + ")");
      tooltip.select("text").text(d[1]-d[0]);
    });
	
	 var tickLabelsInt = ['Furniture','Office Supply','Technology']

    var tickLabels = {};
	for(var i = 0, len = dataset.length; i < len; ++i)
		tickLabels[i] = tickLabelsInt[i%3];
	
// x-axis

  g.append("g")
      .attr("class", "axis")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x).tickFormat(function(d,i){ return tickLabels[i] }))
	  .append("text")
            .attr("x", 0.1* (width - margin.left))
            .attr("y", margin.bottom * 0.6)
            .attr("dx", "0.32em")
            .attr("fill", "#000")
            .attr("font-weight", "bold")
            .attr("text-anchor", "start")
			.attr("font-family", "sans-serif")
			.attr("font-size", 14)
            .text("Central East South West")
			
		.append("text")
            .attr("x", 0.25* (width - margin.left))
            .attr("y", margin.bottom * 0.6)
            .attr("dx", "0.38em")
            .attr("fill", "#000")
            .attr("font-weight", "bold")
            .attr("text-anchor", "start")
			.attr("font-family", "sans-serif")
			.attr("font-size", 14)
            .text("East")
	  .append("text")
            .attr("x", (width - margin.left)/ 2)
            .attr("y", margin.bottom * 0.5)
            .attr("dx", "0.32em")
            .attr("fill", "#000")
            .attr("font-weight", "bold")
            .attr("text-anchor", "start")
			.attr("font-family", "sans-serif")
			.attr("font-size", 14)
            .text("Region/Department");

// Left y-axis
			
	g.append("g")
      .attr("class", "axis")
      .call(d3.axisLeft(y).ticks(null, "s"))
    .append("text")
      .attr("x", - 0.95 *margin.left)
     // .attr("y", y(y.ticks().pop()) + 0.5)
	  .attr("y", height/2)
      .attr("dy", "0.32em")
      .attr("fill", "#000")
      .attr("font-weight", "bold")
      .attr("text-anchor", "start")
	  .attr("font-size", "14px")
      .text("Sales/Profit");

// Right y-axis
// No need
  
//	  g.append("g")
//     .attr("class", "axis")
//    .call(d3.axisRight(y).ticks(null, "s"))
//	  .attr("transform", "translate (" + width + ", 0)")
//    .append("text")
//      .attr("x", 0.35*margin.right)
//	  .attr("y", height/2)
//      .attr("dy", "0.32em")
//      .attr("fill", "#000")
//     .attr("font-weight", "bold")
//      .attr("text-anchor", "start")
//	  .attr("font-size", "14px")
//      .text("Profit");
	
// Legend
	
	var legend = g.append("g")
      .attr("font-family", "sans-serif")
      .attr("font-size", 14)
	  .attr("font-weight", "normal")
      .attr("text-anchor", "end")
    .selectAll("g")
    .data(["Central Profit", "Central Sales", "East Profit", "East Sales", "South Profit", "South Sales", "West Profit", "West Sales"])
    .enter().append("g")
      .attr("transform", function(d, i) { return "translate(0," + i * 20 + ")"; });

	 

	  legend.append("text")
		  .attr("x", width + 0.80 * margin.right)
		  .attr("y", 9.5)
		  .attr("dy", "0.32em")
		  .attr("font-family", "sans-serif")
		  .attr("font-size", 14)
		  .text(function(d) { return d; });
	
	legend.append("rect")
		  .attr("x", width + 0.85 * margin.right)
		  .attr("width", 39)
		  .attr("height", 19)
		  .attr("fill", function(d,i){return colors1(i)});
	  
  

	  
// Prep the tooltip bits, initial display is hidden
  var tooltip = svg.append("g")
    .attr("class", "tooltip")
    .style("display", "none");
      
  tooltip.append("rect")
    .attr("width", 60)
    .attr("height", 20)
    .attr("fill", "white")
    .style("opacity", 0.5);

  tooltip.append("text")
    .attr("x", 30)
    .attr("dy", "1.2em")
    .style("text-anchor", "middle")
    .attr("font-size", "12px")
    .attr("font-weight", "bold");  	

    
}


</script>
</body>
</html>
